<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üé¨ Movie Explorer</title>
<style>
*{box-sizing:border-box;transition:.2s ease;}
body{margin:0;background:#0f0f0f;color:#fff;font-family:"Poppins",Arial,sans-serif;}
header{background:#181818;padding:15px 20px;text-align:center;position:sticky;top:0;z-index:1000;box-shadow:0 2px 10px rgba(0,0,0,.5);}
header h1{margin:0 0 10px;color:#ff4444;font-size:1.8rem;}
.search-bar{display:flex;justify-content:center;align-items:center;gap:10px;flex-wrap:wrap;background:#1c1c1c;border-radius:8px;box-shadow:0 4px 20px rgba(255,68,68,.3);padding:10px;margin-bottom:10px;}
.search-bar input{padding:10px;width:250px;border:none;border-radius:5px;outline:none;font-size:1rem;}
.search-bar button{background:#ff4444;border:none;padding:10px 20px;border-radius:5px;color:#fff;cursor:pointer;font-size:1rem;}
.search-bar button:hover{background:#ff2222;}
section h2{text-align:center;color:#ff4444;margin:10px 0;font-size:1.4rem;}
.movie-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:20px;padding:10px;}
.movie-card{background:#1e1e1e;border-radius:10px;padding:10px;cursor:pointer;box-shadow:0 4px 10px rgba(0,0,0,.5);text-align:center;}
.movie-card:hover{transform:scale(1.05);}
.movie-card img{width:100%;height:270px;object-fit:cover;border-radius:8px;}
.movie-card h3{margin:8px 0 4px;font-size:1.05rem;}
footer{background:#181818;text-align:center;padding:15px;font-size:14px;color:#aaa;}
.hidden{display:none;}
/* Movie details overlay */
#detailView{position:fixed;top:0;left:0;width:100%;height:100%;background:#0f0f0f;overflow-y:auto;padding:20px;display:none;z-index:2000;}
#detailView img{width:260px;border-radius:10px;}
#detailView .info{max-width:800px;margin:auto;display:flex;flex-wrap:wrap;gap:20px;}
#detailView .text{flex:1;}
#detailView h2{color:#ff4444;margin:0 0 10px;}
#closeBtn{position:fixed;top:15px;right:20px;background:#ff4444;color:#fff;border:none;border-radius:50%;width:35px;height:35px;font-size:18px;cursor:pointer;}
#closeBtn:hover{background:#ff2222;}
@media(max-width:600px){
  .search-bar input{width:80%;}
  #detailView img{width:200px;}
}
</style>
</head>
<body>
<header>
  <h1>üé¨ Movie Explorer</h1>
  <div class="search-bar">
    <input id="searchInput" type="text" placeholder="Search a movie...">
    <button id="searchBtn">Search</button>
  </div>
</header>

<main>
  <section id="searchSection" class="hidden">
    <h2>Search Results</h2>
    <div id="movieContainer" class="movie-grid"></div>
  </section>

  <section>
    <h2>Trending Movies</h2>
    <div id="trendingContainer" class="movie-grid"></div>
  </section>
</main>

<footer><p>Made with ‚ù§Ô∏è using OMDb API</p></footer>

<!-- Movie detail view -->
<div id="detailView">
  <button id="closeBtn">√ó</button>
  <div id="detailContent"></div>
  <section>
    <h2>Recommended</h2>
    <div id="recommendContainer" class="movie-grid"></div>
  </section>
</div>

<script>
window.onload=()=>fetchTrending();
document.getElementById("searchBtn").addEventListener("click",async()=>{
  const q=document.getElementById("searchInput").value.trim();
  if(!q)return alert("Enter a movie name!");
  document.getElementById("searchSection").classList.remove("hidden");
  const res=await fetch(`/api/omdb?query=s=${q}`);
  const data=await res.json();
  const box=document.getElementById("movieContainer");
  box.innerHTML="";
  if(data.Response==="True"){data.Search.forEach(m=>box.appendChild(card(m)));}else{box.innerHTML="<p>No results found üò¢</p>";}
});

async function fetchTrending(){
  const keys=["Avengers","Batman","Harry Potter","Spider","Mission Impossible"];
  const q=keys[Math.floor(Math.random()*keys.length)];
  const res=await fetch(`/api/omdb?query=s=${q}`);
  const data=await res.json();
  const box=document.getElementById("trendingContainer");
  box.innerHTML="";
  if(data.Response==="True"){data.Search.slice(0,8).forEach(m=>box.appendChild(card(m)));}
}

function card(m){
  const d=document.createElement("div");
  d.className="movie-card";
  d.innerHTML=`<img src="${m.Poster!=="N/A"?m.Poster:"https://via.placeholder.com/200x300?text=No+Image"}" alt="${m.Title}"><h3>${m.Title}</h3><p>${m.Year}</p>`;
  d.onclick=()=>showDetails(m.imdbID);
  return d;
}

async function showDetails(id){
  const res=await fetch(`/api/omdb?query=i=${id}`);
  const m=await res.json();
  const wrap=document.getElementById("detailContent");
  wrap.innerHTML=`
  <div class="info">
    <img src="${m.Poster!=="N/A"?m.Poster:"https://via.placeholder.com/200x300?text=No+Image"}" alt="${m.Title}">
    <div class="text">
      <h2>${m.Title} (${m.Year})</h2>
      <p><b>Genre:</b> ${m.Genre}</p>
      <p><b>Director:</b> ${m.Director}</p>
      <p><b>Actors:</b> ${m.Actors}</p>
      <p><b>IMDb Rating:</b> ‚≠ê ${m.imdbRating}</p>
      <p><b>Plot:</b> ${m.Plot}</p>
    </div>
  </div>`;
  document.getElementById("detailView").style.display="block";
  fetchRecommend(m);
}
document.getElementById("closeBtn").onclick=()=>document.getElementById("detailView").style.display="none";

async function fetchRecommend(movie){
  const genre=movie.Genre?movie.Genre.split(",")[0].trim():"";
  if(!genre)return;
  const res=await fetch(`/api/omdb?query=s=${genre}`);
  const data=await res.json();
  const box=document.getElementById("recommendContainer");
  box.innerHTML="";
  if(data.Response==="True"){data.Search.filter(x=>x.imdbID!==movie.imdbID).slice(0,6).forEach(m=>box.appendChild(card(m)));}
}
</script>
</body>
</html>
